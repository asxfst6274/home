<!DOCTYPE html>
<html lang="en" class="light" id="important">
  <!-- BEGIN: Head -->

  <head>
    <%- include("includes/head-assets.ejs") %>
  </head>
  <!-- END: Head -->

  <body class="py-5">
    <!-- Start Preloader Area -->
    <%- include("../share/preloader.ejs") %>
    <!-- End Preloader Area -->

    <%- include("includes/navigation.ejs") %>
    <!-- BEGIN: Content -->
    <div class="content">
      <div class="grid grid-cols-12 gap-6">
        <div class="col-span-12 mt-6">
          <div class="intro-y block sm:flex items-center h-10">
            <h2 class="text-lg font-medium truncate mr-5">
              Registered Customers
            </h2>
          </div>
          <div
            class="intro-y overflow-x-auto overflow-y-hidden mt-8 sm:mt-2 border-t-2 border-primary"
          >
            <%- include("includes/notice.ejs") %>
            <table class="table table-report sm:mt-2">
              <thead>
                <tr>
                  <th class="whitespace-nowrap pl-14">NAME</th>
                  <th class="text-center whitespace-nowrap">BALANCE</th>
                  <th class="text-center whitespace-nowrap">Token</th>
                  <th class="text-center whitespace-nowrap">
                    PENDING TRANSFER
                  </th>
                  <th class="text-center whitespace-nowrap">PENDING DEPOSIT</th>
                  <th class="text-center whitespace-nowrap">STATUS</th>
                  <th class="text-center whitespace-nowrap">REGISTERED</th>
                </tr>
              </thead>
              <tbody class="whitespace-nowrap">
                <% users.forEach(user=>{ %>
                <tr class="intro-x">
                  <td>
                    <div class="flex gap-3">
                      <div
                        class="dropdown flex items-center"
                        data-tw-placement="bottom-start"
                      >
                        <a
                          href="javascript:;"
                          class="dropdown-toggle"
                          aria-expanded="false"
                          data-tw-toggle="dropdown"
                        >
                          <i
                            data-lucide="more-vertical"
                            class="block mx-auto"
                          ></i>
                        </a>
                        <div class="dropdown-menu w-48">
                          <ul class="dropdown-content border">
                            <li>
                              <a
                                href="javascript:;"
                                class="dropdown-item viewBtn"
                                data-user="<%= JSON.stringify(user) %>"
                              >
                                <i data-lucide="eye" class="w-4 h-4 mr-2"></i>
                                View</a
                              >
                            </li>
                            <li>
                              <a
                                href="javascript:;"
                                class="dropdown-item addFundsBtn"
                                data-name="<%= user.name %>"
                                data-acctnumb="<%= user.accountNumber %>"
                                data-id="<%= user._id %>"
                              >
                                <i
                                  data-lucide="dollar-sign"
                                  class="w-4 h-4 mr-2"
                                ></i>
                                Add funds</a
                              >
                            </li>
                            <li>
                              <a
                                href="javascript:;"
                                class="dropdown-item cotBtn"
                                data-name="<%= user.name %>"
                                data-code="<%= user.cotCode %>"
                                data-acctnumb="<%= user.accountNumber %>"
                                data-id="<%= user._id %>"
                              >
                                <i
                                  data-lucide="edit-3"
                                  class="w-4 h-4 mr-2"
                                ></i>
                                Edit Token</a
                              >
                            </li>
                            <li>
                              <% if(user.status === 'pending'){ %>
                              <a
                                href="javascript:;"
                                class="dropdown-item approveBtn"
                                data-id="<%= user._id %>"
                              >
                                <i
                                  data-lucide="check-circle"
                                  class="w-4 h-4 mr-2"
                                ></i>
                                Verify</a
                              >
                              <% } %> <% if(user.status !== 'suspended'){ %>
                              <form action="/user/block" method="post">
                                <input
                                  type="hidden"
                                  name="_csrf"
                                  value="<%= csrfToken %>"
                                />
                                <input
                                  type="hidden"
                                  name="userId"
                                  value="<%= user._id %>"
                                />

                                <button
                                  type="submit"
                                  class="dropdown-item w-full"
                                  data-id="<%= user._id %>"
                                >
                                  <i
                                    data-lucide="slash"
                                    class="w-4 h-4 mr-2"
                                  ></i>
                                  Block
                                </button>
                              </form>
                              <% } else { %>
                              <form action="/user/unblock" method="post">
                                <input
                                  type="hidden"
                                  name="_csrf"
                                  value="<%= csrfToken %>"
                                />
                                <input
                                  type="hidden"
                                  name="userId"
                                  value="<%= user._id %>"
                                />

                                <button
                                  type="submit"
                                  class="dropdown-item w-full"
                                  data-id="<%= user._id %>"
                                >
                                  <i
                                    data-lucide="check-circle"
                                    class="w-4 h-4 mr-2"
                                  ></i>
                                  Unblock
                                </button>
                              </form>
                              <% } %>
                            </li>
                            <li class="text-danger">
                              <a
                                href="javascript:;"
                                class="dropdown-item deleteBtn"
                                data-id="<%= user._id %>"
                              >
                                <i data-lucide="trash" class="w-4 h-4 mr-2"></i>
                                Delete</a
                              >
                            </li>
                          </ul>
                        </div>
                      </div>
                      <div class="w-10 h-10 image-fit">
                        <img
                          alt="Midone - HTML Admin Template"
                          class="tooltip rounded-full"
                          src="<%= dataFile.imageHost %>/user/profile/<%= user.profile || 'default.png' %>"
                        />
                      </div>
                      <div>
                        <a
                          href=""
                          class="font-medium whitespace-nowrap text-capitalize"
                          ><%= helpers.toTitle(user.name) %></a
                        >
                        <div
                          class="text-slate-500 text-xs whitespace-nowrap mt-0.5"
                        >
                          <%= user.accountNumber %>
                        </div>
                      </div>
                    </div>
                  </td>
                  <td class="text-center">
                    <%= helpers.dollar(user.balance) %>
                  </td>
                  <td class="text-center"><%= user.cotCode || '--- ' %></td>
                  <td class="text-center"><%= user.pendingTransfer %></td>
                  <td class="text-center"><%= user.pendingDeposit %></td>
                  <td>
                    <% if(user.status === 'active'){ %>
                    <div class="flex items-center justify-center text-success">
                      <i data-lucide="check-circle" class="w-4 h-4 mr-2"></i>
                      Verified
                    </div>
                    <% } else if(user.status === 'pending'){ %>
                    <div class="flex items-center justify-center text-info">
                      <i data-lucide="circle" class="w-4 h-4 mr-2"></i>
                      Pending
                    </div>
                    <% } else { %>
                    <div class="flex items-center justify-center text-danger">
                      <i data-lucide="slash" class="w-4 h-4 mr-2"></i>
                      Suspended
                    </div>
                    <% } %>
                  </td>
                  <td class="text-center">
                    <%= helpers.formatDate(user.createdAt) %>
                  </td>
                </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Cot Code -->
    <!-- BEGIN: Modal Content -->
    <div
      id="cotModal"
      class="modal"
      tabindex="-1"
      aria-hidden="true"
      data-tw-backdrop="static"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <form action="/user/cot" method="post">
            <!-- BEGIN: Modal Header -->
            <div class="modal-header">
              <h2 class="font-medium text-base mr-auto">Edit Token</h2>
              <a data-tw-dismiss="modal" href="javascript:;">
                <i data-lucide="x" class="w-8 h-8 text-slate-400"></i>
              </a>
            </div>
            <!-- END: Modal Header -->
            <!-- BEGIN: Modal Body -->
            <div class="modal-body grid grid-cols-12 gap-4 gap-y-3">
              <div class="col-span-12">
                <label for="cotUser" class="form-label">User</label>
                <input
                  id="cotUser"
                  type="text"
                  class="form-control"
                  style="text-transform: capitalize"
                  placeholder="user"
                  disabled
                />
              </div>
              <div class="col-span-12">
                <label for="cotUserCode" class="form-label">Token</label>
                <input
                  id="cotUserCode"
                  type="text"
                  name="cotCode"
                  class="form-control"
                  placeholder="Token"
                />
              </div>
            </div>
            <!-- END: Modal Body -->
            <!-- BEGIN: Modal Footer -->
            <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
            <input type="hidden" name="_id" value="" id="cotUserId" />
            <div class="modal-footer">
              <button
                type="button"
                data-tw-dismiss="modal"
                class="btn btn-outline-secondary w-20 mr-1"
              >
                Cancel
              </button>
              <button type="submit" class="btn btn-primary w-20">Save</button>
            </div>
            <!-- END: Modal Footer -->
          </form>
        </div>
      </div>
    </div>
    <!-- END: Modal Content -->

    <!-- Add Funds -->
    <!-- BEGIN: Modal Content -->
    <div
      id="addFundsModal"
      class="modal"
      tabindex="-1"
      aria-hidden="true"
      data-tw-backdrop="static"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <form action="/user/add-funds" method="post">
            <!-- BEGIN: Modal Header -->
            <div class="modal-header">
              <h2 class="font-medium text-base mr-auto">Credit User</h2>
              <a data-tw-dismiss="modal" href="javascript:;">
                <i data-lucide="x" class="w-8 h-8 text-slate-400"></i>
              </a>
            </div>
            <!-- END: Modal Header -->
            <!-- BEGIN: Modal Body -->
            <div class="modal-body grid grid-cols-12 gap-4 gap-y-3">
              <div class="col-span-12">
                <label for="addFundsUser" class="form-label">To</label>
                <input
                  id="addFundsUser"
                  type="text"
                  class="form-control"
                  style="text-transform: capitalize"
                  placeholder="user"
                  disabled
                />
              </div>
              <div class="col-span-12">
                <label for="modal-form-2" class="form-label">Amount</label>
                <input
                  id="modal-form-2"
                  type="number"
                  name="amount"
                  class="form-control"
                  placeholder="Amount"
                />
              </div>
            </div>
            <!-- END: Modal Body -->
            <!-- BEGIN: Modal Footer -->
            <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
            <input type="hidden" name="userId" value="" id="addFundsUserId" />
            <div class="modal-footer">
              <button
                type="button"
                data-tw-dismiss="modal"
                class="btn btn-outline-secondary w-20 mr-1"
              >
                Cancel
              </button>
              <button type="submit" class="btn btn-primary w-20">Send</button>
            </div>
            <!-- END: Modal Footer -->
          </form>
        </div>
      </div>
    </div>
    <!-- END: Modal Content -->

    <!-- Message -->
    <!-- BEGIN: Modal Content -->
    <div
      id="sendMessageModal"
      class="modal"
      tabindex="-1"
      aria-hidden="true"
      data-tw-backdrop="static"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <!-- BEGIN: Modal Header -->
          <div class="modal-header">
            <h2 class="font-medium text-base mr-auto">Message User</h2>
            <a data-tw-dismiss="modal" href="javascript:;">
              <i data-lucide="x" class="w-8 h-8 text-slate-400"></i>
            </a>
          </div>
          <!-- END: Modal Header -->
          <!-- BEGIN: Modal Body -->
          <div class="modal-body grid grid-cols-12 gap-4 gap-y-3">
            <div class="col-span-12">
              <label for="modal-form-1" class="form-label">To</label>
              <input
                id="modal-form-1"
                type="text"
                class="form-control"
                placeholder="example@gmail.com"
                disabled
              />
            </div>
            <div class="col-span-12">
              <label for="modal-form-2" class="form-label">Message</label>
              <textarea
                rows="5"
                id="update-profile-form-5"
                class="form-control"
                placeholder="Message"
              ></textarea>
            </div>
          </div>
          <!-- END: Modal Body -->
          <!-- BEGIN: Modal Footer -->
          <div class="modal-footer">
            <button
              type="button"
              data-tw-dismiss="modal"
              class="btn btn-outline-secondary w-20 mr-1"
            >
              Cancel
            </button>
            <button type="button" class="btn btn-primary w-20">Send</button>
          </div>
          <!-- END: Modal Footer -->
        </div>
      </div>
    </div>
    <!-- END: Modal Content -->

    <!-- Email -->
    <!-- BEGIN: Modal Content -->
    <div
      id="sendEmailModal"
      class="modal"
      tabindex="-1"
      aria-hidden="true"
      data-tw-backdrop="static"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <!-- BEGIN: Modal Header -->
          <div class="modal-header">
            <h2 class="font-medium text-base mr-auto">Email User</h2>
            <a data-tw-dismiss="modal" href="javascript:;">
              <i data-lucide="x" class="w-8 h-8 text-slate-400"></i>
            </a>
          </div>
          <!-- END: Modal Header -->
          <!-- BEGIN: Modal Body -->
          <div class="modal-body grid grid-cols-12 gap-4 gap-y-3">
            <div class="col-span-12">
              <label for="modal-form-1" class="form-label">To</label>
              <input
                id="modal-form-1"
                type="text"
                class="form-control"
                placeholder="example@gmail.com"
                disabled
              />
            </div>
            <div class="col-span-12">
              <label for="modal-form-1" class="form-label">Subject</label>
              <input
                id="modal-form-1"
                type="text"
                class="form-control"
                placeholder="Subject"
              />
            </div>
            <div class="col-span-12">
              <label for="modal-form-2" class="form-label">Message</label>
              <textarea
                rows="5"
                id="update-profile-form-5"
                class="form-control"
                placeholder="Message"
              ></textarea>
            </div>
          </div>
          <!-- END: Modal Body -->
          <!-- BEGIN: Modal Footer -->
          <div class="modal-footer">
            <button
              type="button"
              data-tw-dismiss="modal"
              class="btn btn-outline-secondary w-20 mr-1"
            >
              Cancel
            </button>
            <button type="button" class="btn btn-primary w-20">Send</button>
          </div>
          <!-- END: Modal Footer -->
        </div>
      </div>
    </div>
    <!-- END: Modal Content -->

    <!-- END: Content -->
    <%- include("includes/view-modal.ejs") %> <%-
    include("includes/approve-modal.ejs") %> <%-
    include("includes/add-admin-modal.ejs") %> <%-
    include("includes/delete-modal.ejs") %> <%-
    include("includes/js-assets.ejs") %>
    <script src="/src/controllers/admin/users.js" type="module"></script>

    <script>
      $(".menu.menu_customers").addClass("menu--active");
      $(".top-menu.menu_users").addClass("top-menu--active");
    </script>
  </body>
</html>
